{% extends "base.html" %}

{% block title %}Jarvis Commands{% endblock %}

{% block content %}
<!-- Header -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card bg-primary text-white">
            <div class="card-body text-center py-4">
                <h1><i class="bi bi-mic-fill"></i> Jarvis Voice Assistant</h1>
                <p class="lead mb-3">Control your computer with natural voice commands</p>
                <div class="mt-3">
                    <button id="startJarvisBtn" class="btn btn-light btn-lg me-2">
                        <i class="bi bi-play-circle-fill"></i> Start Jarvis
                    </button>
                    <button id="stopJarvisBtn" class="btn btn-outline-light btn-lg" style="display: none;">
                        <i class="bi bi-stop-circle-fill"></i> Stop Jarvis
                    </button>
                    <span id="jarvisStatus" class="badge bg-secondary ms-3">Not Running</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- How to Use -->
<div class="row mb-4">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h4 class="mb-0"><i class="bi bi-play-circle"></i> How to Use Jarvis</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <div class="text-center">
                            <div class="display-1 text-success">1</div>
                            <h5>Start Jarvis</h5>
                            <code>python jarvis.py</code>
                            <p class="small mt-2">Or type in the chat window</p>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="text-center">
                            <div class="display-1 text-success">2</div>
                            <h5>Say the Wake Word</h5>
                            <p><strong>"Jarvis"</strong></p>
                            <p class="small mt-2">Wait for it to listen</p>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="text-center">
                            <div class="display-1 text-success">3</div>
                            <h5>Give Command</h5>
                            <p><strong>"search Python"</strong></p>
                            <p class="small mt-2">Jarvis will execute!</p>
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-info mt-3">
                    <i class="bi bi-lightbulb"></i> <strong>Tip:</strong> You can also type commands directly in the chat window without saying "Jarvis"!
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Commands List -->
<div class="row mb-4">
    <div class="col-12">
        <h3 class="mb-3"><i class="bi bi-list-check"></i> Available Commands</h3>
    </div>
    
    {% for command in commands %}
    <div class="col-md-6 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title text-primary">
                    <i class="bi bi-chevron-right"></i> {{ command.command }}
                </h5>
                <p class="card-text text-muted mb-0">{{ command.description }}</p>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Command Categories -->
<div class="row mb-4">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="bi bi-bookmark-star"></i> Command Examples by Category</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <!-- Web & Search -->
                    <div class="col-md-6 mb-4">
                        <h5 class="text-primary">üåê Web & Search</h5>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <strong>Jarvis search machine learning</strong>
                                <br><small class="text-muted">Opens Google search</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis youtube relaxing music</strong>
                                <br><small class="text-muted">Searches YouTube</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis wikipedia artificial intelligence</strong>
                                <br><small class="text-muted">Gets Wikipedia summary</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis location Eiffel Tower</strong>
                                <br><small class="text-muted">Opens Google Maps</small>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- System Control -->
                    <div class="col-md-6 mb-4">
                        <h5 class="text-primary">‚öôÔ∏è System Control</h5>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <strong>Jarvis volume up</strong>
                                <br><small class="text-muted">Increases volume</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis volume down</strong>
                                <br><small class="text-muted">Decreases volume</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis mute</strong>
                                <br><small class="text-muted">Mutes audio</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis screenshot</strong>
                                <br><small class="text-muted">Takes screenshot</small>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Gesture Control -->
                    <div class="col-md-6 mb-4">
                        <h5 class="text-primary">‚úã Gesture Control</h5>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <strong>Jarvis launch gesture</strong>
                                <br><small class="text-muted">Starts hand gesture control</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis stop gesture</strong>
                                <br><small class="text-muted">Stops gesture recognition</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis gesture status</strong>
                                <br><small class="text-muted">Check if gestures are active</small>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Information -->
                    <div class="col-md-6 mb-4">
                        <h5 class="text-primary">‚ÑπÔ∏è Information</h5>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <strong>Jarvis what's the time</strong>
                                <br><small class="text-muted">Tells current time</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis date</strong>
                                <br><small class="text-muted">Tells current date</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis help</strong>
                                <br><small class="text-muted">Shows all commands</small>
                            </li>
                            <li class="list-group-item">
                                <strong>Jarvis who are you</strong>
                                <br><small class="text-muted">Introduction</small>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Tips & Tricks -->
<div class="row mb-4">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header bg-warning">
                <h4 class="mb-0"><i class="bi bi-star-fill"></i> Tips & Tricks</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h5><i class="bi bi-check2-circle"></i> Do's</h5>
                        <ul>
                            <li>Speak clearly and at normal pace</li>
                            <li>Say "Jarvis" before each command</li>
                            <li>Use the chat interface if voice isn't working</li>
                            <li>Combine with gestures for full control</li>
                            <li>Wait for "Listening..." before speaking</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h5><i class="bi bi-x-circle"></i> Don'ts</h5>
                        <ul>
                            <li>Don't speak too fast or too slow</li>
                            <li>Don't give commands in noisy environment</li>
                            <li>Don't forget the "Jarvis" wake word</li>
                            <li>Don't interrupt while Jarvis is speaking</li>
                            <li>Don't use complex sentence structures</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Troubleshooting -->
<div class="row mb-4">
    <div class="col-lg-12">
        <div class="card border-danger">
            <div class="card-header bg-danger text-white">
                <h4 class="mb-0"><i class="bi bi-tools"></i> Troubleshooting</h4>
            </div>
            <div class="card-body">
                <div class="accordion" id="troubleshootingAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
                                Jarvis can't hear me
                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#troubleshootingAccordion">
                            <div class="accordion-body">
                                <strong>Solutions:</strong>
                                <ul>
                                    <li>Check microphone permissions</li>
                                    <li>Verify microphone is connected and working</li>
                                    <li>Move closer to the microphone</li>
                                    <li>Reduce background noise</li>
                                    <li>Use the chat interface instead</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo">
                                Jarvis misunderstands my commands
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                            <div class="accordion-body">
                                <strong>Solutions:</strong>
                                <ul>
                                    <li>Speak more clearly</li>
                                    <li>Use exact command phrases shown above</li>
                                    <li>Check internet connection (Google Speech API)</li>
                                    <li>Restart Jarvis</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree">
                                Chat interface not working
                            </button>
                        </h2>
                        <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                            <div class="accordion-body">
                                <strong>Solutions:</strong>
                                <ul>
                                    <li>Refresh the browser window</li>
                                    <li>Check if jarvis.py is running</li>
                                    <li>Install Eel: <code>pip install eel</code></li>
                                    <li>Check port 27007 is not blocked</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Action Buttons -->
<div class="row mb-4">
    <div class="col-12 text-center">
        <a href="/gestures" class="btn btn-primary btn-lg me-2">
            <i class="bi bi-hand-index"></i> View Gestures
        </a>
        <a href="/add-gesture" class="btn btn-outline-primary btn-lg">
            <i class="bi bi-plus-circle"></i> Add Custom Gesture
        </a>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// Check Jarvis status on page load
function checkJarvisStatus() {
    fetch('/api/jarvis-status')
        .then(res => res.json())
        .then(data => {
            updateJarvisUI(data.running);
        });
}

function updateJarvisUI(isRunning) {
    const startBtn = document.getElementById('startJarvisBtn');
    const stopBtn = document.getElementById('stopJarvisBtn');
    const status = document.getElementById('jarvisStatus');
    
    if (isRunning) {
        startBtn.style.display = 'none';
        stopBtn.style.display = 'inline-block';
        status.textContent = 'Running';
        status.className = 'badge bg-success ms-3';
    } else {
        startBtn.style.display = 'inline-block';
        stopBtn.style.display = 'none';
        status.textContent = 'Not Running';
        status.className = 'badge bg-secondary ms-3';
    }
}

document.getElementById('startJarvisBtn').addEventListener('click', function() {
    this.disabled = true;
    fetch('/api/start-jarvis', { method: 'POST' })
        .then(res => res.json())
        .then(data => {
            if (data.status === 'success') {
                alert('‚úÖ ' + data.message);
                updateJarvisUI(true);
            } else {
                alert('‚ùå ' + data.message);
            }
            this.disabled = false;
        });
});

document.getElementById('stopJarvisBtn').addEventListener('click', function() {
    this.disabled = true;
    fetch('/api/stop-jarvis', { method: 'POST' })
        .then(res => res.json())
        .then(data => {
            if (data.status === 'success') {
                alert('‚úÖ ' + data.message);
                updateJarvisUI(false);
            } else {
                alert('‚ùå ' + data.message);
            }
            this.disabled = false;
        });
});

// Check status every 5 seconds
checkJarvisStatus();
setInterval(checkJarvisStatus, 5000);
</script>
{% endblock %}
